# General strcture

This directory handles processing data in `../data/raw_data` into a form more amenable to a MySQL database. In particular, the `.json` files generated by `../py/json_creators` are processed so that each entity is split into multiple instances of itself, one for each generation. Each instance has the correct data for that given generation. For example, Butterfree, a Gen 1 Pokemon, would have 8 different copies, and its first 5 copies would have a `special_attack` of 80, whereas subsequent copies would have a `special_attack` of 90. 

The `utils` folder contains all the functions necessary for processing, and `index.js` simply composes them into a single script.

# Extended example: Adding Natures

Assuming the conventions in `../py/json_creators/README.md` were followed, little needs to be done in this step, only a few lines of code added to `index.js`. At this point, one can generally follow the pattern of existing code.

1. In Region 1, `require()` the necessary `.json` file and store the resulting object in `natures` (follow the pattern for the other entities at the top of the region).
2. Still in Region 1, apply `serializeDict(natures)` and store the result in `natureArr`. This does two things:
  - Converts the entity object into an array, with each entry corresponding to an entity (before, the keys of the object were the names of the entity).
  - Extends each of the patch lists so that there is an entry for every generation. For example, Butterfree's patch list `[[80, 1], [90, 6]]` becomes `[[80, 1], [80, 2], [80, 3], [80, 4], [80, 5], [90, 6], [90, 7], [90, 8]]`.
3. In Region 4, apply `splitArr` to `natureArr`. This returns another array, this time with each entity split into multiple different entries, each entry corresponding to a given generation. Since Natures were introduced in Gen 3, and the current generation is Gen 8, each Nature will have 6 different entries.
4. In Region 7, add `['natures.json', splitNatureArr]` to `FILENAMES_AND_ARRAYS`.
5. Run `node src/processing/index.js` in the terminal, and the code should run successfully. You should now have `natures.json` in `../data/processed_data`.