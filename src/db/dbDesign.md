# Pokemon Database Design

## Entities and attributes
All `id`'s are generated by AUTO-INCREMENT. `introduced` refers to the generation in which the entity was introduced.

- `generation`
  - `id`, *PK*
  - `code`, ENUM
- `description`
  - `id`, *PK*
  - `text`, TINYTEXT
- `sprite`
  - `id`, *PK*
  - `url`, TINYTEXT
- `version_group`
  - `id`, *PK*
  - `code`, ENUM
- `ability`
  - `id`, *PK*
  - `name`, VARCHAR(45)
  - `introduced`, TINYINT
  - `affects_item`, TINYINT
- `item`
  - `id`, *PK*
  - `name`, VARCHAR(45)
  - `introduced`, TINYINT
  - `item_type`, ENUM
- `effect`
  - `id`, *PK*
  - `name`, VARCHAR(45)
  - `introduced`, INT
- `usage_method`
  - `id`, *PK*
  - `name`, VARCHAR(45)
  - `introduced`, INT
- `status`
  - `id`, *PK*
  - `name`, VARCHAR(45)
- `move`
  - `id`, *PK*
  - `name`, VARCHAR(45)
  - `power`, SMALLINT
  - `pp`, TINYINT
  - `accuracy`, TINYINT
  - `category`, ENUM
  - `priority`, TINYINT
  - `contact`, TINYINT
  - `target`, ENUM
  - `introduced`, INT
- `stat`
  - `id`, *PK*
  - `name`, ENUM
- `ptype`
  - `id`, *PK*
  - `name`, ENUM
  - `introduced`, INT
- `pokemon`
  - `id`, *PK*
  - `name`, VARCHAR(45)
  - `dex`, SMALLINT
  - `height`, SMALLINT
  - `weight`, SMALLINT
  - `introduced`, TINYINT
  - `hp`, TINYINT
  - `attack`, TINYINT
  - `defense`, TINYINT
  - `special_attack`, TINYINT
  - `special_defense`, TINYINT
  - `speed`, TINYINT

## Relationships

### 1-to-1
- `move`
  - `move_requires_type`, with `ptype`

### 1-to-n
Every entity except `effect`, `status`, `usage_method`, `stat`, `description`, `version_group`, and `sprite` has `generation` as an identifying foreign key. For some 1-to-n relationships, we need to store additional data, so we extract them to separate tables.

- `pokemon`
  - `pokemon_evolution`, 1 prevolution to n evolutions
    - Prevolution and evolution as primary keys
    - `method`, TINYTEXT
    - `event_pokemon`
      - ADD SOMETHING
  - `pokemon_form`, 1 base form to n variants
    - Base Pokemon and variant Pokemon as primary keys
    - `form_type`, ENUM
  - `cosmetic_form`, 1 base form to n cosmetic forms
- `move`
  - `ptype`, 1 type to n moves
  - `usage_method`, 1 usage method to n moves
- `item`
  - `nature_power_type`, 1 type to n items
    - `power`, TINYINT

### m-to-n

- `pokemon`
  - `pokemon_type`, with `ptype`
  - `pokemon_move`, with `move`
    - `learn_method`, VARCHAR(4)
  - `pokemon_ability`, with `ability`
    - `slot`, ENUM
- `ptype`
  - `type_matchup`, with `ptype` (a `ptype` entry is even related to itself)
    - `multiplier`, DECIMAL(3,2)
- `move`
  - `move_stat`, with `stat`
    - `stage`, TINYINT
    - `target`, ENUM
    - `chance`, DECIMAL(5,2)
  - `move_causes_status`, with `status`
    - `chance`, DECIMAL(5,2)
  - `move_resists_status`, with `status`
  - `move_effect`, with `effect`
  - `move_requires_pokemon`, with `pokemon`
  - `move_requires_item`, with `item`
- `ability`
  - `ability_resists_type`, with `ptype`
    - `multiplier`, DECIMAL(4,3)
  - `ability_boosts_type`, with `ptype`
    - `multiplier`, DECIMAL(4,3)
  - `ability_stat`, with `stat`
    - `stage`, TINYINT
    - `multiplier`, DECIMAL(4,3)
  - `ability_causes_status`, with `status`
    - `probability`, DECIMAL(4,3)
  - `ability_resists_status`, with `status`
  - `ability_effect`, with `effect`
  - `ability_resists_usage_method`, with `usage_method`
    - `multiplier`, DECIMAL(4,3)
  - `ability_boosts_usage_method`, with `usage_method`
    - `multiplier`, DECIMAL(4,3)
- `item`
  - `item_requires_pokemon`, with `pokemon`
  - `item_boosts_type`, with `ptype`
    - `multiplier`, DECIMAL(4,3)
  - `item_resists_type`, with `ptype`
    - `multiplier`, DECIMAL(4,3)
  - `item_resists_usage_method`, with `usage_method`
    - `multiplier`, DECIMAL(4,3)
  - `item_modifies_stat`, with `stat`
    - `stage`, TINYINT
    - `multiplier`, DECIMAL(4,3)
  - `item_causes_status`, with `status`
  - `item_resists_status`, with `status`
- `version_group`
  - `version_group_description`, with `description`
  - `version_group_sprite`, with `sprite`

### Three-fold relationships
Since `description`'s and `sprite`'s often depend on `version_group` as opposed to `generation`, in contrast with most entities staying the same across `version_group`'s while changing across `generation`'s, their relationships with the other entities are more complicated.

For example, each `ability` can have multiple `description`'s across `version_group`'s within the same `generation`, and the same `description` can apply to different `generation`'s of the same `ability`, giving an m-to-n relationship. Moreover, this relationship has the `version_group` as a foreign key. The primary key of the `ability` (which consists in part of the primary key for the corresponding `generation`), the primary key of the `description`, and the primary key of the `version_group` together make up the primary key for a given row in this relationship.

The following tables have this relationship structure:

- `description`
  - `description_ability`
  - `description_move`
  - `description_item`
- `sprite`
  - `sprite_pokemon`
  - `sprite_item`

## Indices

`pokemon`
- 